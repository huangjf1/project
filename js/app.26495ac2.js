(function(e){function t(t){for(var r,n,s=t[0],l=t[1],m=t[2],u=0,h=[];u<s.length;u++)n=s[u],a[n]&&h.push(a[n][0]),a[n]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r]);c&&c(t);while(h.length)h.shift()();return o.push.apply(o,m||[]),i()}function i(){for(var e,t=0;t<o.length;t++){for(var i=o[t],r=!0,s=1;s<i.length;s++){var l=i[s];0!==a[l]&&(r=!1)}r&&(o.splice(t--,1),e=n(n.s=i[0]))}return e}var r={},a={app:0},o=[];function n(t){if(r[t])return r[t].exports;var i=r[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=r,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var m=0;m<s.length;m++)t(s[m]);var c=l;o.push([0,"chunk-vendors"]),i()})({0:function(e,t,i){e.exports=i("56d7")},"04ed":function(e,t,i){"use strict";var r=i("7412"),a=i.n(r);a.a},"35a1":function(e,t,i){},"3e41":function(e,t,i){},"41b7":function(e,t,i){"use strict";var r=i("3e41"),a=i.n(r);a.a},"56d7":function(e,t,i){"use strict";i.r(t);i("7f7f"),i("cadf"),i("551c"),i("f751"),i("097d");var r=i("a026"),a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"app"}},[i("keep-alive",[e.$route.meta.keepAlive?i("router-view"):e._e()],1),e.$route.meta.keepAlive?e._e():i("router-view")],1)},o=[],n=(i("4917"),{name:"App",data:function(){return{}},created:function(){var e=this,t=!!navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/);t?(window.addEventListener("pagehide",function(){localStorage.setItem("stateInfo",JSON.stringify(e.$store.state))}),localStorage.stateInfo&&(this.$store.replaceState(Object.assign({},this.$store.state,JSON.parse(localStorage.stateInfo))),localStorage.removeItem("stateInfo"))):(window.addEventListener("beforeunload",function(){localStorage.setItem("stateInfo",JSON.stringify(e.$store.state))}),localStorage.stateInfo&&(this.$store.replaceState(Object.assign({},this.$store.state,JSON.parse(localStorage.stateInfo))),localStorage.removeItem("stateInfo")))}}),s=n,l=(i("7c55"),i("2877")),m=Object(l["a"])(s,a,o,!1,null,null,null),c=m.exports,u=i("8c4f"),h=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"container"},[i("canvas",{ref:"imgCanvas1",attrs:{id:"canvasInput1"}}),i("canvas",{ref:"imgCanvas2",attrs:{id:"canvasInput2"}}),i("div",{staticClass:"setting-btn",style:{right:e.drawerShow?"600px":"0"},attrs:{type:"primary"},on:{click:function(t){e.drawerShow=!e.drawerShow}}},[i("i",{directives:[{name:"show",rawName:"v-show",value:!e.drawerShow,expression:"!drawerShow"}],staticClass:"el-icon-setting",staticStyle:{"font-size":"30px"}}),i("i",{directives:[{name:"show",rawName:"v-show",value:e.drawerShow,expression:"drawerShow"}],staticClass:"el-icon-close",staticStyle:{"font-size":"30px"}})]),i("el-drawer",{attrs:{visible:e.drawerShow,size:"600px",title:"设置"},on:{"update:visible":function(t){e.drawerShow=t}}},[i("el-form",{ref:"form",attrs:{rules:1==e.form.radio?e.rules:e.defalutRules,model:e.form,"label-width":"140px"}},[i("el-form-item",{attrs:{label:"原型图：",prop:"imgOne"}},[i("el-upload",{staticClass:"avatar-uploader",attrs:{"show-file-list":!1,action:"","on-change":e.uploadChange,"auto-upload":!1}},[""!=e.form.imgOne?i("img",{staticClass:"avatar",attrs:{src:e.form.imgOne}}):i("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),i("el-form-item",{attrs:{label:"宽：",prop:"imgOneWidth"}},[i("el-input",{staticStyle:{width:"50%"},attrs:{type:"number"},on:{input:e.oneWidthChange},model:{value:e.form.imgOneWidth,callback:function(t){e.$set(e.form,"imgOneWidth",t)},expression:"form.imgOneWidth"}})],1),i("el-form-item",{attrs:{label:"高：",prop:"imgOneHeight"}},[i("el-input",{staticStyle:{width:"50%"},attrs:{type:"number"},on:{input:e.oneHeightChange},model:{value:e.form.imgOneHeight,callback:function(t){e.$set(e.form,"imgOneHeight",t)},expression:"form.imgOneHeight"}})],1),i("el-form-item",{attrs:{label:"是否锁定纵横比："}},[i("el-checkbox",{attrs:{size:"medium"},model:{value:e.form.checkOne,callback:function(t){e.$set(e.form,"checkOne",t)},expression:"form.checkOne"}})],1),i("el-form-item",{attrs:{label:"对比图：",prop:"imgTwo"}},[i("el-upload",{staticClass:"avatar-uploader",attrs:{"show-file-list":!1,action:"","on-change":e.uploadChangeOne,"auto-upload":!1}},[""!=e.form.imgTwo?i("img",{staticClass:"avatar",attrs:{src:e.form.imgTwo}}):i("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),i("el-form-item",{attrs:{label:"宽：",prop:"imgTwoWidth"}},[i("el-input",{staticStyle:{width:"50%"},attrs:{type:"number"},on:{input:e.twoWidthChange},model:{value:e.form.imgTwoWidth,callback:function(t){e.$set(e.form,"imgTwoWidth",t)},expression:"form.imgTwoWidth"}})],1),i("el-form-item",{attrs:{label:"高：",prop:"imgTwoheight"}},[i("el-input",{staticStyle:{width:"50%"},attrs:{type:"number"},on:{input:e.twoHeightChange},model:{value:e.form.imgTwoheight,callback:function(t){e.$set(e.form,"imgTwoheight",t)},expression:"form.imgTwoheight"}})],1),i("el-form-item",{attrs:{label:"是否锁定纵横比："}},[i("el-checkbox",{attrs:{size:"medium "},model:{value:e.form.checkTwo,callback:function(t){e.$set(e.form,"checkTwo",t)},expression:"form.checkTwo"}})],1),i("el-form-item",{attrs:{label:"差异面积：",required:""}},[i("el-radio-group",{model:{value:e.form.radio,callback:function(t){e.$set(e.form,"radio",t)},expression:"form.radio"}},[i("div",[i("el-radio",{staticStyle:{display:"flex",width:"500px"},attrs:{label:1}},[i("span",{staticStyle:{color:"#606266"}},[e._v("差异面积")]),i("el-select",{staticStyle:{width:"80px",margin:"0 10px"},attrs:{disabled:1!=e.form.radio},model:{value:e.typeOne,callback:function(t){e.typeOne=t},expression:"typeOne"}},[i("el-option",{attrs:{label:"≥",value:1}}),i("el-option",{attrs:{label:"≤",value:2}}),i("el-option",{attrs:{label:"<",value:3}}),i("el-option",{attrs:{label:">",value:4}}),i("el-option",{attrs:{label:"=",value:5}})],1),i("el-form-item",{staticStyle:{display:"inline"},attrs:{prop:"num"}},[i("el-input",{staticStyle:{width:"80px"},attrs:{type:"number",disabled:1!=e.form.radio},model:{value:e.form.num,callback:function(t){e.$set(e.form,"num",t)},expression:"form.num"}})],1)],1)],1),i("div",{staticStyle:{"margin-top":"10px"}},[i("el-radio",{attrs:{label:2}},[i("el-form-item",{attrs:{prop:"areaMinNum"}},[i("el-input",{staticStyle:{width:"80px"},attrs:{disabled:1==e.form.radio,type:"number"},model:{value:e.form.areaMinNum,callback:function(t){e.$set(e.form,"areaMinNum",t)},expression:"form.areaMinNum"}})],1),i("el-select",{staticStyle:{width:"80px",margin:"0 10px"},attrs:{disabled:1==e.form.radio},model:{value:e.typeTwo,callback:function(t){e.typeTwo=t},expression:"typeTwo"}},[i("el-option",{attrs:{label:"≤",value:1}}),i("el-option",{attrs:{label:"<",value:2}})],1),i("span",{staticStyle:{color:"#606266"}},[e._v("差异面积")]),i("el-select",{staticStyle:{width:"80px",margin:"0 10px"},attrs:{disabled:1==e.form.radio},model:{value:e.typeThree,callback:function(t){e.typeThree=t},expression:"typeThree"}},[i("el-option",{attrs:{label:"≤",value:1}}),i("el-option",{attrs:{label:"<",value:2}})],1),i("el-form-item",{attrs:{prop:"areaMaxNum"}},[i("el-input",{staticStyle:{width:"80px"},attrs:{disabled:1==e.form.radio,type:"number"},model:{value:e.form.areaMaxNum,callback:function(t){e.$set(e.form,"areaMaxNum",t)},expression:"form.areaMaxNum"}})],1)],1)],1)])],1),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("开始对比")])],1)],1)],1)],1)},g=[],f=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},d=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"right-panel-wrap"},[i("div",{staticClass:"icon"}),i("div",{staticClass:"right-panel"})])}],p={},w=p,v=(i("04ed"),Object(l["a"])(w,f,d,!1,null,"a15b62a0",null)),b=v.exports,O={components:{RightPanel:b},data:function(){return{drawerShow:!1,form:{imgOne:i("98a8"),imgOneWidth:1920,imgOneHeight:1080,checkOne:!0,imgTwo:i("593c"),imgTwoWidth:1920,imgTwoheight:1080,checkTwo:!0,num:100,areaMinNum:0,areaMaxNum:100,radio:1},scaleOne:1920/1080,scaleTwo:1920/1080,rules:{imgOne:[{required:!0,message:"请上传图片",trigger:"blur"}],imgOneWidth:[{required:!0,message:"请输入宽",trigger:"blur"}],imgOneHeight:[{required:!0,message:"请输入高",trigger:"blur"}],imgTwo:[{required:!0,message:"请上传图片",trigger:"blur"}],imgTwoWidth:[{required:!0,message:"请输入宽",trigger:"blur"}],imgTwoheight:[{required:!0,message:"请输入高",trigger:"blur"}],num:[{required:!0,message:"请输入范围",trigger:"blur"}]},defalutRules:{imgOne:[{required:!0,message:"请上传图片",trigger:"blur"}],imgOneWidth:[{required:!0,message:"请输入宽",trigger:"blur"}],imgOneHeight:[{required:!0,message:"请输入高",trigger:"blur"}],imgTwo:[{required:!0,message:"请上传图片",trigger:"blur"}],imgTwoWidth:[{required:!0,message:"请输入宽",trigger:"blur"}],imgTwoheight:[{required:!0,message:"请输入高",trigger:"blur"}],areaMinNum:[{required:!0,message:"请输入范围",trigger:"blur"}],areaMaxNum:[{required:!0,message:"请输入范围",trigger:"blur"}]},cavsDom1:"",cavsDom2:"",ctx1:"",ctx2:"",loading:null,typeOne:1,typeTwo:1,typeThree:1}},mounted:function(){this.initCanvas()},methods:{uploadChange:function(e){this.filetoBase64(e.raw,!0)},uploadChangeOne:function(e){this.filetoBase64(e.raw,!1)},filetoBase64:function(e,t){var i=this,r=new FileReader;r.readAsDataURL(e),r.onload=function(e){var r=new Image;r.src=e.target.result,r.onload=function(){t?(i.form.imgOne=e.target.result,i.form.imgOneWidth=r.width,i.form.imgOneHeight=r.height,i.scaleOne=r.width/r.height):(i.form.imgTwo=e.target.result,i.form.imgTwoWidth=r.width,i.form.imgTwoheight=r.height,i.scaleTwo=r.width/r.height)}}},oneWidthChange:function(){""!==this.scaleOne&&this.form.checkOne&&(this.form.imgOneHeight=(this.form.imgOneWidth/this.scaleOne).toFixed(0))},oneHeightChange:function(){""!==this.scaleOne&&this.form.checkOne&&(this.form.imgOneWidth=(this.form.imgOneHeight*this.scaleOne).toFixed(0))},twoWidthChange:function(){""!==this.scaleTwo&&this.form.checkTwo&&(this.form.imgTwoheight=(this.form.imgTwoWidth/this.scaleTwo).toFixed(0))},twoHeightChange:function(){""!==this.scaleTwo&&this.form.checkTwo&&(this.form.imgTwoWidth=(this.form.imgTwoheight*this.scaleTwo).toFixed(0))},submit:function(){var e=this;this.$refs["form"].validate(function(t){if(!t)return console.log("error submit!!"),!1;0!==e.form.imgOneWidth&&0!==e.form.imgTwoWidth&&0!==e.form.imgOneHeight&&0!==e.form.imgTwoheight||e.form.imgOneWidth===e.form.imgTwoWidth?2===e.form.radio&&1*e.form.areaMinNum>=1*e.form.areaMaxNum?e.$message({message:"最大范围不能小于等于最小范围",type:"warning"}):(1*e.form.imgOneWidth!==1*e.form.imgTwoWidth||(e.form.imgOneHeight,e.form.imgTwoheight),e.drawerShow=!1,e.initCanvas()):e.$message({message:"宽高不能为0",type:"warning"})})},initCanvas:function(){var e=this;this.loading=this.$loading({lock:!0,text:"对比中请稍后",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),this.cavsDom1=this.$refs.imgCanvas1,this.cavsDom2=this.$refs.imgCanvas2,this.ctx1=this.$refs.imgCanvas1.getContext("2d"),this.ctx2=this.$refs.imgCanvas2.getContext("2d");var t=new Image,i=new Image;t.src=this.form.imgOne,i.src=this.form.imgTwo,t.onload=function(){e.cavsDom1.width=e.form.imgOneWidth<=e.form.imgTwoWidth?e.form.imgTwoWidth:e.form.imgOneWidth,e.cavsDom1.height=e.form.imgOneHeight<=e.form.imgTwoheight?e.form.imgTwoheight:e.form.imgOneHeight,e.ctx1.drawImage(t,0,0,e.form.imgOneWidth,e.form.imgOneHeight,0,0,e.form.imgOneWidth,e.form.imgOneHeight)},i.onload=function(){e.cavsDom2.width=e.form.imgOneWidth<=e.form.imgTwoWidth?e.form.imgTwoWidth:e.form.imgOneWidth,e.cavsDom2.height=e.form.imgOneHeight<=e.form.imgTwoheight?e.form.imgTwoheight:e.form.imgOneHeight,e.ctx2.drawImage(i,0,0,e.form.imgTwoWidth,e.form.imgTwoheight,0,0,e.form.imgTwoWidth,e.form.imgTwoheight)},this.$nextTick(function(){setTimeout(function(){e.start()},1e3)})},start:function(){var e=cv.imread("canvasInput1"),t=cv.imread("canvasInput2"),i=new cv.Mat,r=new cv.Mat;cv.cvtColor(e,i,cv.COLOR_RGBA2GRAY),cv.cvtColor(t,r,cv.COLOR_RGBA2GRAY);var a=new cv.Mat,o=new cv.Mat;cv.subtract(i,r,o,a,-1);var n=new cv.Mat;cv.subtract(r,i,n);var s=new cv.Mat;cv.add(o,n,s);var l=new cv.Mat,m=new cv.MatVector,c=new cv.MatVector;if(cv.findContours(s,m,l,cv.RETR_CCOMP,cv.CHAIN_APPROX_SIMPLE),0===m.size())return this.loading.close(),void this.$message({message:"暂未发现差异,请更换图片",type:"warning"});for(var u=0;u<m.size();++u){var h=new cv.Mat,g=m.get(u);cv.convexHull(g,h,!1,!0),c.push_back(h),g.delete(),h.delete()}for(var f=!1,d=0;d<m.size();++d){var p=new cv.Scalar(255,0,0,255),w=Math.abs(cv.contourArea(m.get(d)));1==this.form.radio?(1==this.typeOne&&w>=this.form.num&&(f=!0,cv.drawContours(e,c,d,p,2,8,l,0),cv.drawContours(t,c,d,p,2,8,l,0)),2==this.typeOne&&w<=this.form.num&&(f=!0,cv.drawContours(e,c,d,p,2,8,l,0),cv.drawContours(t,c,d,p,2,8,l,0)),3==this.typeOne&&w<this.form.num&&(f=!0,cv.drawContours(e,c,d,p,2,8,l,0),cv.drawContours(t,c,d,p,2,8,l,0)),4==this.typeOne&&w>this.form.num&&(f=!0,cv.drawContours(e,c,d,p,2,8,l,0),cv.drawContours(t,c,d,p,2,8,l,0)),5==this.typeOne&&w==this.form.num&&(f=!0,cv.drawContours(e,c,d,p,2,8,l,0),cv.drawContours(t,c,d,p,2,8,l,0))):(1==this.typeTwo&&1==this.typeThree&&w>=this.form.areaMinNum&&w<=this.form.areaMaxNum&&(f=!0,cv.drawContours(e,c,d,p,2,8,l,0),cv.drawContours(t,c,d,p,2,8,l,0)),1==this.typeTwo&&2==this.typeThree&&w>=this.form.areaMinNum&&w<this.form.areaMaxNum&&(f=!0,cv.drawContours(e,c,d,p,2,8,l,0),cv.drawContours(t,c,d,p,2,8,l,0)),2==this.typeTwo&&1==this.typeThree&&w>this.form.areaMinNum&&w<=this.form.areaMaxNum&&(f=!0,cv.drawContours(e,c,d,p,2,8,l,0),cv.drawContours(t,c,d,p,2,8,l,0)),2==this.typeTwo&&2==this.typeThree&&w>this.form.areaMinNum&&w<this.form.areaMaxNum&&(f=!0,cv.drawContours(e,c,d,p,2,8,l,0),cv.drawContours(t,c,d,p,2,8,l,0)))}if(!f)return this.loading.close(),void this.$message({message:"暂未发现差异，请调整差异面积范围或更换图片",type:"warning"});cv.imshow("canvasInput2",t),cv.imshow("canvasInput1",e),this.loading.close()}}},T=O,y=(i("41b7"),Object(l["a"])(T,h,g,!1,null,"03391c47",null)),x=y.exports;r["default"].use(u["a"]);var C=new u["a"]({routes:[{path:"/",name:"index",component:x,meta:{title:"对比",keepAlive:!1,isBack:!1}}]}),S=i("2f62");r["default"].use(S["a"]);var k=new S["a"].Store({state:{infoList:[],total:0,detail:{}},mutations:{setList:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.total=t.totalCount,e.infoList=t.dataList},setDetail:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.detail=t}}}),W=k,M=(i("35a1"),i("5c96")),$=i.n(M);i("0fae");r["default"].config.productionTip=!1,r["default"].use($.a),C.beforeEach(function(e,t,i){e.meta.title&&(document.title=e.meta.title),"confirm"==t.name&&(e.meta.isBack=!0),i()}),new r["default"]({router:C,store:W,render:function(e){return e(c)}}).$mount("#app")},"593c":function(e,t,i){e.exports=i.p+"img/2.e66ae9cb.jpg"},"5c48":function(e,t,i){},7412:function(e,t,i){},"7c55":function(e,t,i){"use strict";var r=i("5c48"),a=i.n(r);a.a},"98a8":function(e,t,i){e.exports=i.p+"img/1.07488da5.jpg"}});