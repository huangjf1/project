(function(e){function t(t){for(var o,n,s=t[0],m=t[1],c=t[2],h=0,g=[];h<s.length;h++)n=s[h],r[n]&&g.push(r[n][0]),r[n]=0;for(o in m)Object.prototype.hasOwnProperty.call(m,o)&&(e[o]=m[o]);l&&l(t);while(g.length)g.shift()();return a.push.apply(a,c||[]),i()}function i(){for(var e,t=0;t<a.length;t++){for(var i=a[t],o=!0,s=1;s<i.length;s++){var m=i[s];0!==r[m]&&(o=!1)}o&&(a.splice(t--,1),e=n(n.s=i[0]))}return e}var o={},r={app:0},a=[];function n(t){if(o[t])return o[t].exports;var i=o[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=o,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],m=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var l=m;a.push([0,"chunk-vendors"]),i()})({0:function(e,t,i){e.exports=i("56d7")},"04ed":function(e,t,i){"use strict";var o=i("7412"),r=i.n(o);r.a},"35a1":function(e,t,i){},"56d7":function(e,t,i){"use strict";i.r(t);i("7f7f"),i("cadf"),i("551c"),i("f751"),i("097d");var o=i("a026"),r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"app"}},[i("keep-alive",[e.$route.meta.keepAlive?i("router-view"):e._e()],1),e.$route.meta.keepAlive?e._e():i("router-view")],1)},a=[],n=(i("4917"),{name:"App",data:function(){return{}},created:function(){var e=this,t=!!navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/);t?(window.addEventListener("pagehide",function(){localStorage.setItem("stateInfo",JSON.stringify(e.$store.state))}),localStorage.stateInfo&&(this.$store.replaceState(Object.assign({},this.$store.state,JSON.parse(localStorage.stateInfo))),localStorage.removeItem("stateInfo"))):(window.addEventListener("beforeunload",function(){localStorage.setItem("stateInfo",JSON.stringify(e.$store.state))}),localStorage.stateInfo&&(this.$store.replaceState(Object.assign({},this.$store.state,JSON.parse(localStorage.stateInfo))),localStorage.removeItem("stateInfo")))}}),s=n,m=(i("7c55"),i("2877")),c=Object(m["a"])(s,r,a,!1,null,null,null),l=c.exports,h=i("8c4f"),g=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"container"},[i("canvas",{ref:"imgCanvas1",attrs:{id:"canvasInput1"}}),i("canvas",{ref:"imgCanvas2",attrs:{id:"canvasInput2"}}),i("div",{staticClass:"setting-btn",style:{right:e.drawerShow?"600px":"0"},attrs:{type:"primary"},on:{click:function(t){e.drawerShow=!e.drawerShow}}},[i("i",{directives:[{name:"show",rawName:"v-show",value:!e.drawerShow,expression:"!drawerShow"}],staticClass:"el-icon-setting",staticStyle:{"font-size":"30px"}}),i("i",{directives:[{name:"show",rawName:"v-show",value:e.drawerShow,expression:"drawerShow"}],staticClass:"el-icon-close",staticStyle:{"font-size":"30px"}})]),i("el-drawer",{attrs:{visible:e.drawerShow,size:"600px",title:"设置"},on:{"update:visible":function(t){e.drawerShow=t}}},[i("el-form",{ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"140px"}},[i("el-form-item",{attrs:{label:"原型图：",prop:"imgOne"}},[i("el-upload",{staticClass:"avatar-uploader",attrs:{"show-file-list":!1,action:"","on-change":e.uploadChange,"auto-upload":!1}},[""!=e.form.imgOne?i("img",{staticClass:"avatar",attrs:{src:e.form.imgOne}}):i("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),i("el-form-item",{attrs:{label:"宽：",prop:"imgOneWidth"}},[i("el-input",{staticStyle:{width:"50%"},attrs:{type:"number"},on:{input:e.oneWidthChange},model:{value:e.form.imgOneWidth,callback:function(t){e.$set(e.form,"imgOneWidth",t)},expression:"form.imgOneWidth"}})],1),i("el-form-item",{attrs:{label:"高：",prop:"imgOneHeight"}},[i("el-input",{staticStyle:{width:"50%"},attrs:{type:"number"},on:{input:e.oneHeightChange},model:{value:e.form.imgOneHeight,callback:function(t){e.$set(e.form,"imgOneHeight",t)},expression:"form.imgOneHeight"}})],1),i("el-form-item",{attrs:{label:"是否锁定纵横比："}},[i("el-checkbox",{attrs:{size:"medium"},model:{value:e.form.checkOne,callback:function(t){e.$set(e.form,"checkOne",t)},expression:"form.checkOne"}})],1),i("el-form-item",{attrs:{label:"对比图：",prop:"imgTwo"}},[i("el-upload",{staticClass:"avatar-uploader",attrs:{"show-file-list":!1,action:"","on-change":e.uploadChangeOne,"auto-upload":!1}},[""!=e.form.imgTwo?i("img",{staticClass:"avatar",attrs:{src:e.form.imgTwo}}):i("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),i("el-form-item",{attrs:{label:"宽：",prop:"imgTwoWidth"}},[i("el-input",{staticStyle:{width:"50%"},attrs:{type:"number"},on:{input:e.twoWidthChange},model:{value:e.form.imgTwoWidth,callback:function(t){e.$set(e.form,"imgTwoWidth",t)},expression:"form.imgTwoWidth"}})],1),i("el-form-item",{attrs:{label:"高：",prop:"imgTwoheight"}},[i("el-input",{staticStyle:{width:"50%"},attrs:{type:"number"},on:{input:e.twoHeightChange},model:{value:e.form.imgTwoheight,callback:function(t){e.$set(e.form,"imgTwoheight",t)},expression:"form.imgTwoheight"}})],1),i("el-form-item",{attrs:{label:"是否锁定纵横比："}},[i("el-checkbox",{attrs:{size:"medium "},model:{value:e.form.checkTwo,callback:function(t){e.$set(e.form,"checkTwo",t)},expression:"form.checkTwo"}})],1),i("el-form-item",{attrs:{label:"对比精度：",prop:"num"}},[i("el-input",{staticStyle:{width:"50%"},attrs:{type:"number"},model:{value:e.form.num,callback:function(t){e.$set(e.form,"num",t)},expression:"form.num"}})],1),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("开始对比")])],1)],1)],1)],1)},f=[],u=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},d=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"right-panel-wrap"},[i("div",{staticClass:"icon"}),i("div",{staticClass:"right-panel"})])}],w={},v=w,p=(i("04ed"),Object(m["a"])(v,u,d,!1,null,"a15b62a0",null)),O=p.exports,b={components:{RightPanel:O},data:function(){return{drawerShow:!1,form:{imgOne:i("98a8"),imgOneWidth:1920,imgOneHeight:1080,checkOne:!0,imgTwo:i("593c"),imgTwoWidth:1920,imgTwoheight:1080,checkTwo:!0,num:100},scaleOne:1920/1080,scaleTwo:1920/1080,rules:{imgOne:[{required:!0,message:"请上传图片",trigger:"blur"}],imgOneWidth:[{required:!0,message:"请输入宽",trigger:"blur"}],imgOneHeight:[{required:!0,message:"请输入高",trigger:"blur"}],imgTwo:[{required:!0,message:"请上传图片",trigger:"blur"}],imgTwoWidth:[{required:!0,message:"请输入宽",trigger:"blur"}],imgTwoheight:[{required:!0,message:"请输入高",trigger:"blur"}],num:[{required:!0,message:"请输入精度",trigger:"blur"}]},cavsDom1:"",cavsDom2:"",ctx1:"",ctx2:"",loading:null}},mounted:function(){this.initCanvas()},methods:{uploadChange:function(e){this.filetoBase64(e.raw,!0)},uploadChangeOne:function(e){this.filetoBase64(e.raw,!1)},filetoBase64:function(e,t){var i=this,o=new FileReader;o.readAsDataURL(e),o.onload=function(e){var o=new Image;o.src=e.target.result,o.onload=function(){t?(i.form.imgOne=e.target.result,i.form.imgOneWidth=o.width,i.form.imgOneHeight=o.height,i.scaleOne=o.width/o.height):(i.form.imgTwo=e.target.result,i.form.imgTwoWidth=o.width,i.form.imgTwoheight=o.height,i.scaleTwo=o.width/o.height)}}},oneWidthChange:function(){""!==this.scaleOne&&this.form.checkOne&&(this.form.imgOneHeight=(this.form.imgOneWidth/this.scaleOne).toFixed(0))},oneHeightChange:function(){""!==this.scaleOne&&this.form.checkOne&&(this.form.imgOneWidth=(this.form.imgOneHeight*this.scaleOne).toFixed(0))},twoWidthChange:function(){""!==this.scaleTwo&&this.form.checkTwo&&(this.form.imgTwoheight=(this.form.imgTwoWidth/this.scaleTwo).toFixed(0))},twoHeightChange:function(){""!==this.scaleTwo&&this.form.checkTwo&&(this.form.imgTwoWidth=(this.form.imgTwoheight*this.scaleTwo).toFixed(0))},submit:function(){var e=this;this.$refs["form"].validate(function(t){if(!t)return console.log("error submit!!"),!1;0!==e.form.imgOneWidth&&0!==e.form.imgTwoWidth&&0!==e.form.imgOneHeight&&0!==e.form.imgTwoheight||e.form.imgOneWidth===e.form.imgTwoWidth?(console.log(e.form.imgOneWidth,e.form.imgTwoWidth,e.form.imgOneHeight,e.form.imgTwoheight),1*e.form.imgOneWidth!==1*e.form.imgTwoWidth||(e.form.imgOneHeight,e.form.imgTwoheight),e.drawerShow=!1,e.initCanvas()):e.$message({message:"宽高不能为0",type:"warning"})})},initCanvas:function(){var e=this;this.loading=this.$loading({lock:!0,text:"对比中请稍后",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),this.cavsDom1=this.$refs.imgCanvas1,this.cavsDom2=this.$refs.imgCanvas2,this.ctx1=this.$refs.imgCanvas1.getContext("2d"),this.ctx2=this.$refs.imgCanvas2.getContext("2d");var t=new Image,i=new Image;t.src=this.form.imgOne,i.src=this.form.imgTwo,t.onload=function(){e.cavsDom1.width=e.form.imgOneWidth<=e.form.imgTwoWidth?e.form.imgTwoWidth:e.form.imgOneWidth,e.cavsDom1.height=e.form.imgOneHeight<=e.form.imgTwoheight?e.form.imgTwoheight:e.form.imgOneHeight,e.ctx1.drawImage(t,0,0,e.form.imgOneWidth,e.form.imgOneHeight,0,0,e.form.imgOneWidth,e.form.imgOneHeight)},i.onload=function(){e.cavsDom2.width=e.form.imgOneWidth<=e.form.imgTwoWidth?e.form.imgTwoWidth:e.form.imgOneWidth,e.cavsDom2.height=e.form.imgOneHeight<=e.form.imgTwoheight?e.form.imgTwoheight:e.form.imgOneHeight,e.ctx2.drawImage(i,0,0,e.form.imgTwoWidth,e.form.imgTwoheight,0,0,e.form.imgTwoWidth,e.form.imgTwoheight)},this.$nextTick(function(){setTimeout(function(){e.start()},1e3)})},start:function(){var e=cv.imread("canvasInput1"),t=cv.imread("canvasInput2"),i=new cv.Mat,o=new cv.Mat;cv.cvtColor(e,i,cv.COLOR_RGBA2GRAY),cv.cvtColor(t,o,cv.COLOR_RGBA2GRAY);var r=new cv.Mat,a=new cv.Mat;cv.subtract(i,o,a,r,-1);var n=new cv.Mat;cv.subtract(o,i,n);var s=new cv.Mat;cv.add(a,n,s);var m=new cv.Mat,c=new cv.MatVector,l=new cv.MatVector;if(cv.findContours(s,c,m,cv.RETR_CCOMP,cv.CHAIN_APPROX_SIMPLE),0===c.size())return this.loading.close(),void this.$message({message:"暂未发现差异,请更换图片",type:"warning"});for(var h=0;h<c.size();++h){var g=new cv.Mat,f=c.get(h);cv.convexHull(f,g,!1,!0),l.push_back(g),f.delete(),g.delete()}for(var u=!1,d=0;d<c.size();++d){var w=new cv.Scalar(255,0,0,255),v=Math.abs(cv.contourArea(c.get(d)));v>this.form.num&&(u=!0,cv.drawContours(e,l,d,w,2,8,m,0),cv.drawContours(t,l,d,w,2,8,m,0))}if(!u)return this.loading.close(),void this.$message({message:"暂未发现差异，请调整对比精度或更换图片",type:"warning"});cv.imshow("canvasInput2",t),cv.imshow("canvasInput1",e),this.loading.close()}}},T=b,C=(i("6238"),Object(m["a"])(T,g,f,!1,null,"37c78350",null)),x=C.exports;o["default"].use(h["a"]);var W=new h["a"]({routes:[{path:"/",name:"index",component:x,meta:{title:"对比",keepAlive:!1,isBack:!1}}]}),S=i("2f62");o["default"].use(S["a"]);var y=new S["a"].Store({state:{infoList:[],total:0,detail:{}},mutations:{setList:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.total=t.totalCount,e.infoList=t.dataList},setDetail:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.detail=t}}}),k=y,$=(i("35a1"),i("5c96")),I=i.n($);i("0fae");o["default"].config.productionTip=!1,o["default"].use(I.a),W.beforeEach(function(e,t,i){e.meta.title&&(document.title=e.meta.title),"confirm"==t.name&&(e.meta.isBack=!0),i()}),new o["default"]({router:W,store:k,render:function(e){return e(l)}}).$mount("#app")},"593c":function(e,t,i){e.exports=i.p+"img/2.e66ae9cb.jpg"},"5bde":function(e,t,i){},"5c48":function(e,t,i){},6238:function(e,t,i){"use strict";var o=i("5bde"),r=i.n(o);r.a},7412:function(e,t,i){},"7c55":function(e,t,i){"use strict";var o=i("5c48"),r=i.n(o);r.a},"98a8":function(e,t,i){e.exports=i.p+"img/1.07488da5.jpg"}});